<!DOCTYPE html>
<html>

  <meta charset="utf-8">

  <title>Chapt 1 - Demo 4</title>

  <body>

    <style>
      video {
        width: 307px;
        height: 250px;
        background: red;
        border: 1px solid #ccc;
      }
      .grayscale {
        filter: grayscale(1);
      }
      .sepia {
        filter: sepia(1);
      }
      .blur {
        filter: blur(3px);
      }
      .brightness {}
      .contrast {}
      .hue-rotate {}
      .hue-rotate2 {}
      .hue-rotate3 {}
      .saturate {}
      .invert {}
      </style>

      <p><button id="button">photo</button></p>
      <video autoplay></video>

      <script>
      var idx = 0;
      var button = document.querySelector('#button');
      var video = document.querySelector('video');
      var filters = ['grayscale', 'sepia', 'blur', 'brightness',
                     'contrast', 'hue-rotate', 'hue-rotate2',
                     'hue-rotate3', 'saturate', 'invert', ''];

      var errorCallback = function(e) {
        console.log('Reeeejected!', e);
      };

      // Not showing vendor prefixes.
      navigator.getUserMedia({video: true, audio: true}, function(localMediaStream) {
        video.src = window.URL.createObjectURL(localMediaStream);
      }, errorCallback);

      function changeFilter(e) {
        video.className = '';
        var effect = filters[idx++ % filters.length]; // loop through filters.
        if (effect) {
          video.classList.add(effect);
        }
      }

      button.addEventListener('click', changeFilter, false);
      </script>

  </body>

</html>
